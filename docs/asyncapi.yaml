asyncapi: 2.6.0
id: urn:example:chat-ws
defaultContentType: application/json
info:
  title: Chat Backend WebSocket API
  version: 0.1.0

servers:
  prod:
    url: wss://<host>
    protocol: wss

channels:
  /ws:
    subscribe:
      operationId: receiveMessage
      message:
        $ref: '#/components/messages/ChatMessageOut'
    publish:
      operationId: sendMessage
      message:
        $ref: '#/components/messages/ChatMessageIn'

components:
  schemas:
    ChatPayload:
      x-parser-schema-id: ChatPayload
      type: object
      properties:
        username: { type: string, description: 投稿者 }
        content:  { type: string, description: 本文 }
      required: [username, content]

  messages:
    ChatMessageIn:
      name: MessageIn
      summary: クライアント→サーバー
      payload: { $ref: '#/components/schemas/ChatPayload' }
      examples:
        - name: send
          payload: { username: "Alice", content: "Hello!" }

    ChatMessageOut:
      name: MessageOut
      summary: サーバー→クライアント（ブロードキャスト）
      payload: { $ref: '#/components/schemas/ChatPayload' }
      examples:
        - name: receive
          payload: { username: "Bob", content: "Hi!" }
